{"version":3,"sources":["lenaViews/ProductsView/ProductsView.jsx","lenaHelpers/Helpers.js"],"names":["Paging","lazy","FilterCategory","CardServices","NewProductCard","Basket","ProductsView","props","useState","totalItems","setTotalItems","view","currentProducts","setCurrentProducts","setCurrentPage","products","setProducts","selectedCategory","setSelectedCategory","storage","length","updateBasket","setUpdateBasket","delivery","setDelivery","support","setSupport","returns","setReturns","photos","setPhotos","isMD","getCSSQuery","useMediaQuery","isSMD","getCurrentProducts","currentPage","totalPages","pageLimit","productsTemp","offset","currentProductsTemp","slice","getProducts","setIsLoading","api","then","data","totalItemsTemp","catch","err","console","log","toBasket","product","limit","updateBasketTemp","useEffect","conf","config","Linker","navigate","useNavigate","type","className","title","onClick","route","text","Fragment","style","backgroundImage","isProductsSMD","setCategory","map","idx","key","isToBuy","showPrice","totalRecords","pageNeighbours","onPageChanged","page","sizing","alignment","hidden","Object","keys","photoCollection","index","item","innerIndex","group","src","width","alt","wantedQuery","isXL","query","isLG","isSM"],"mappings":"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","file":"static/js/15.a4eba016.chunk.js","sourcesContent":["\r\nimport './ProductsView.css';\r\nimport React, { lazy, useState, useEffect } from \"react\";\r\nimport * as api from \"../../lenaHelpers/APIRequests.js\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport * as storage from '../../lenaHelpers/LocalStorage.js';\r\nimport { useMediaQuery } from 'react-responsive';\r\nimport { getCSSQuery } from '../../lenaHelpers/Helpers';\r\nimport {\r\n  LightgalleryProvider,\r\n  LightgalleryItem\r\n} from \"react-lightgallery\";\r\nimport \"lightgallery.js/dist/css/lightgallery.css\";\r\nconst Paging = lazy(() => import(\"../../components/Paging\"));\r\nconst FilterCategory = lazy(() => import(\"../../lenaViews/CategoryView\"));\r\nconst CardServices = lazy(() => import(\"../../lenaViews/ServicesView\"));\r\n\r\nconst NewProductCard = lazy(() =>\r\n  import(\"../NewProductCard/NewProductCard\")\r\n);\r\n\r\nconst Basket = lazy(() =>\r\n  import(\"../../lenaViews/Basket/Basket\")\r\n);\r\n\r\n\r\n\r\nexport default function ProductsView(props) {\r\n        const [totalItems, setTotalItems] = useState(0);\r\n        const [view] = useState('list');\r\n        const [currentProducts, setCurrentProducts] = useState([]);\r\n        const [, setCurrentPage] = useState(null);\r\n        const [products, setProducts] = useState([]);\r\n        const [selectedCategory, setSelectedCategory] = useState('');\r\n        const [updateBasket, setUpdateBasket] = \r\n            useState((storage.getBasket() ?? []).length);\r\n\r\n        const [delivery, setDelivery] = useState(0);\r\n        const [support, setSupport] = useState(0);\r\n        const [returns, setReturns] = useState(0);\r\n\r\n        const [photos, setPhotos] = useState({});\r\n\r\n        const isMD = getCSSQuery(useMediaQuery, 'md');\r\n        const isSMD = getCSSQuery(useMediaQuery, 'smd');\r\n\r\n        const pageLimitDefault = 9;\r\n\r\n      useEffect(() => {\r\n        getProducts();\r\n\r\n        api.config('delivery').then((conf)=>{\r\n          setDelivery(conf.config);\r\n        });\r\n\r\n      api.config('support').then((conf)=>{\r\n          setSupport(conf.config);\r\n      });\r\n\r\n      api.config('returns').then((conf)=>{\r\n          setReturns(conf.config);\r\n      });\r\n\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      }, []);\r\n\r\n      useEffect(() => {\r\n        getProducts();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      }, [selectedCategory]);\r\n\r\n      useEffect(() => {\r\n        getCurrentProducts(1, 0, pageLimitDefault);\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      }, [products]);\r\n    \r\n      function onPageChanged(page) {\r\n        const { currentPage, totalPages, pageLimit } = page;\r\n        getCurrentProducts(currentPage, totalPages, pageLimit);\r\n      };\r\n\r\n      function getCurrentProducts(currentPage, totalPages, pageLimit){\r\n        let productsTemp = products;\r\n        if(productsTemp && productsTemp.length){\r\n          const offset = (currentPage - 1) * pageLimit;\r\n          const currentProductsTemp = productsTemp.slice(offset, offset + pageLimit);\r\n      \r\n          setCurrentPage(currentPage);\r\n          setCurrentProducts(currentProductsTemp);\r\n        }\r\n      }\r\n    \r\n      /* function onChangeView(newView) {\r\n        setView( view );\r\n      }; */\r\n    \r\n      function getProducts (){\r\n        props.setIsLoading(true);\r\n        api.products(selectedCategory).then((data)=>{\r\n          setProducts(data);\r\n          if(data && data.length){\r\n            const totalItemsTemp = data.length;\r\n            setTotalItems(totalItemsTemp);\r\n          }\r\n\r\n          props.setIsLoading(false);\r\n        }).catch((err)=>{\r\n          console.log(err);\r\n          props.setIsLoading(false);\r\n        });\r\n      };\r\n\r\n      function toBasket(product) {\r\n        const limit = +storage.getOrdersLimit() ?? 20;\r\n        const updateBasketTemp = updateBasket + 1;\r\n\r\n        if(updateBasketTemp <= limit){\r\n          storage.addProductToBasket(product);\r\n          setUpdateBasket(updateBasketTemp);\r\n        }\r\n      }\r\n\r\n      const Linker = (props) =>{\r\n        const navigate = useNavigate();\r\n        return(  <button\r\n          type=\"button\"\r\n          className=\"btn btn-sm btn-primary base-button-color\"\r\n          title=\"navigate\"\r\n          onClick={()=>{navigate(props.route)}}\r\n        >\r\n        {props.text}\r\n        </button>);\r\n      }\r\n\r\n\r\n    return (\r\n        <React.Fragment>\r\n        <LightgalleryProvider>\r\n          <div\r\n            className={\"p-5 bg-primary bs-cover\" + (isMD? \" less-padding-pv\" : \"\")}\r\n            style={{\r\n              backgroundImage: \"url(../../images/LenaTestProducts/banner.png)\",\r\n            }}\r\n          >\r\n            <div className=\"container text-center container-header-pv\">\r\n              {isMD ? \r\n                  <></> :\r\n                  <Linker text={'Acompanhar Encomenda'} route={'/FollowPurchase'}></Linker>}\r\n              <span className=\"display-5 px-3 bg-white rounded shadow\">\r\n                Produtos\r\n              </span>\r\n              <div className={(isSMD? \"actions-smd-pv\" : \"actions-md-pv\")}>\r\n                {isMD ? \r\n                  <Linker text={'Acompanhar Encomenda'} route={'/FollowPurchase'}></Linker> :\r\n                   <></>}\r\n                <Basket updateBasket={updateBasket} isProductsSMD={isSMD} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n         \r\n          <div className=\"container-fluid mb-3 products-for-margin-top\">\r\n            <div className=\"row\">\r\n              <div className=\"col-md-3\">\r\n                <FilterCategory setCategory={setSelectedCategory} setIsLoading={props.setIsLoading} />\r\n                {isMD ? <></> : <CardServices\r\n                  delivery={delivery}\r\n                  support={support}\r\n                  returns={returns}\r\n                  />}\r\n              </div>\r\n              <div className=\"col-md-5\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-md-8\">\r\n                    <span className=\"align-middle font-weight-bold total-per-category-text\">\r\n                      {totalItems} na categoria{\" \"}\r\n                      <span className=\"text-warning\">{selectedCategory}</span>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <hr />\r\n                <div className=\"row g-3\">\r\n                  {view === \"list\" &&\r\n                    currentProducts.map((product, idx) => {\r\n                      return (\r\n                        <div key={idx} className=\"col-md-12\">\r\n                          <NewProductCard \r\n                            data={product}  \r\n                            toBasket={toBasket} \r\n                            isToBuy={true} \r\n                            showPrice={true}\r\n                            photos={photos}\r\n                            setPhotos={setPhotos}\r\n                            />\r\n                        </div>\r\n                      );\r\n                    })}\r\n                    {isMD ? <CardServices /> : <></>}\r\n                </div>\r\n                <hr />\r\n                <Paging\r\n                  totalRecords={totalItems ?? 0}\r\n                  pageLimit={pageLimitDefault}\r\n                  pageNeighbours={3}\r\n                  onPageChanged={onPageChanged}\r\n                  sizing=\"\"\r\n                  alignment=\"justify-content-center\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div hidden={true}>\r\n            {Object.keys(photos).map((photoCollection, index)=>{\r\n                return photos[photoCollection].map((item, innerIndex)=>{\r\n                  return(\r\n                  <LightgalleryItem key={index} group={photoCollection} src={item}>\r\n                    <img src={item} style={{ width: \"100%\" }} alt={\"\"}/>\r\n                  </LightgalleryItem>\r\n                  );\r\n                })\r\n              })\r\n            }\r\n        </div>\r\n          </LightgalleryProvider>\r\n        </React.Fragment>\r\n    )\r\n}\r\n","/* eslint-disable react-hooks/rules-of-hooks */\r\nexport const getCSSQuery = (useMediaQuery, wantedQuery) => {\r\n    const isXL = useMediaQuery({ query: '(min-width: 1824px)' });\r\n    const isLG = useMediaQuery({ query: '(max-width: 1224px)' });\r\n    const isMD = useMediaQuery({ query: '(max-width: 766px)' });\r\n    const isSMD = useMediaQuery({ query: '(max-width: 450px)' });\r\n    const isSM = useMediaQuery({ query: '(max-width: 360px)' });\r\n\r\n    switch (wantedQuery) {\r\n        case \"xl\":\r\n            return isXL;\r\n        case \"lg\":\r\n            return isLG;\r\n        case \"md\":\r\n            return isMD;\r\n        case \"smd\":\r\n            return isSMD;\r\n        case \"sm\":\r\n            return isSM;\r\n    \r\n        default:\r\n            return false;\r\n    }\r\n}"],"sourceRoot":""}